The UI is 'soft' in that the position of the buttons is entirely described by the html, the
colours of events by the CSS and the positions of zones on the image map by the configuration file.

The image file can be any jpg or png file, and can be sized to suit the UI required or the UI
could be constructed without an image.

The configuration file is shared by the UI and the server. It contains a list of json objects, some
keys for which are used by both UI and server, others are exclusive for one or the other.

The configuration file basics can be interactively generated using the -c command line switch. This
will cause the zones to be activated one by one in the order of 1-wire discovery and the user is
prompted for the zone number they wish to allocate to them. This allows the hardware connections
to the various valves and pumps to be defined. The additional data required in the configuration
can then be edited into this skeleton.

Password protect of the UI is handled by a file called passfile in the data directory. An example,
as generated by -A command line switch, for user 'admin', password 'admin' is supplied.

json keys used by UI in html file
```
"zone":             int        index to a specific item
"id":               alphanum   used for diagnostics, etc
"x":                int        % (0-(100-w)) of distance from left of image map
"y":                int        % (0-(100-h)) of distance down from top of image map
"w":                int        % (0-100) width of box drawn no image map
"h":                int        % (0-100) height of box drawn on image map
"selectable":       bool       if the user can select it for programming
"name":             alphanum   plain text displayable name
```

json keys used for normal programable zones
```
"zone":             int        index to a specific item
"id":               alphanum   used for diagnostics, etc
"aorb":             bool       indicates channel A or B on the DS2413 driver
"address":          hexstring  <family>.<serialnumber> 1-wire address
"flow":             int        flow rate in litres/minute
"current":          int        current draw of valve in milliamps
```

json boolean keys that modify a zone
```
"ispump":           bool       zone controls a pump
"isfrost":          bool       frost protection applies
"istest":           bool       is a virtual zone that triggers test mode
"isoutput":         bool       defines a 1-wire device that controls an output
"issensor":         bool       defines a 1-wire device that is read as a sensor
"isspare":          bool       indicates a zone that is not used
```

json keys that pass useful information about a pump
```
"minflow":          int        minimum flow of a pump in litres/minute
"nomflow":          int        nominal flow of a pump in litres/minute
"maxflow":          int        maximum flow of a pump in litres/minute
"maxstarts":        int        maximum number of starts of a pump allowed per hour
"isstock":          bool       pump/feed that supplies taps and stock troughs
"start":            int        time in hhmm format of when to start a pump with the isstock attribute
"end":              int        time in hhmm format of when to stop a pump with the isstock attribute
```

json keys that pass useful information about a sensor
```
"path":             alphanum   string that defines the owfs node to access
"type":             int        what type of sensor: CURRENT = 1, EXTTEMP = 2, INTTEMP = 3, SETTIME = 4, GETTIME = 5
```

json keys that identify virtual zones
```
"group"             int        identifier for a group from 1-15
"zones"             array      list of zones in a group
```

experimental keys
```
"zoom":             int        optional zoom factor. Determines whether to try and show name of the zone
                               doesn't work with image maps very well!!
```

The server responds to requests for '/status' and '/timedata' and the json objects returned
are used in conjunction with CSS style code to set the colour and other attributes.

The 'status' display uses the key "status" for CSS selection and the key "description" for 
the mouseover title that is displayed for each irrigation zone. The following global keys are
also available:
```
"time"              string     time in HH:MM:SS format
"temperature"       int        scaled by 100 to allow local decimal resolution
"current"           int        scaled by 1000 (i.e. mA)
"flow"              int        litre/min
"frost"             string     one of "on", "man", "arm", "run", "off" to indicate current state
```

The 'timeline' display uses the key "status" to determine the type of box displayed in the timeline:
```
"start"             time       defined using the format template "%a, %d %b %Y %H:%M:%S %z"
"end"               time       define the extent of an event
"status"            string     its class is derived from this
"description"       string     is just that! 
"mindate"           time       defines the left limit (i.e. in the past)
"maxdate"           time       define the limits of the display (usually +/- 8 days)
```


Examples


A small zone that runs the misters in a tunnel house
```
"zone":  8                       // arbitrary number from 1 to MAXZONES
"id": "tunnel"                   // label used for debugging
"x": 82                          // how far across from top left
"y": 42                          // how far down
"w":  2                          // quite narrow!!
"h":  6                          // tall
"zoom": 13                       // values > 10 dipsplay the whole name in the box
"selectable": true               // can be selected to program
"name": "Tunnel House"           // friendly name
"aorb": true                     // PIO.A
"address": "3a.2d3201000000"     // owfs format 1-wire address
"flow": 8                        // 8 l/m flow rate
"current": 160                   // draws 160mA
```

A zone that describes the valve that allows the domestic feed to pressurise the irrigation system to run
stock troughs and taps about the place. It also handles low volume irrigation up to the flow rate of the main pump.
```
"zone": 32
"id": "dpfeed"
"x": 62
"y": 65
"w":  2
"h":  2
"zoom": 13
"selectable": false
"name": "Domestic Feed"
"aorb": false
"address": "3a.9b8d03000000"
"flow": 0
"isdpfeed": true                 // tell the system its special
"start": 0700                    // even if no demand then turn on at 7:00am anyway
"end": 2100                      // if no demand the turn off at night
"current": 160
```

A zone that describes a pump
```
"zone": 16
"id": "well"
"x": 62                          // it appears on the image map 
"y": 68
"w":  2
"h":  3
"zoom": 13
"selectable": false              // but the user can't select it from the UI - operation is automatic
"name": "Well Pump"
"aorb": true                     // 1-wire data of how to control it
"address": "3a.824b01000000"     // not as valve but the contactor that runs it is driven the same way
"flow": 100                      // flow rate below which the pump switches off
"ispump": true                   // describes what it is
"maxstarts": 20                  // locks for 3 mins when stopped to prevent abuse
"maxflow": 230                   // when calculating a group, how much should be done at once
"current": 120
```


A (virtual) zone that has no direct valves but instead holds a group of zones. It appears on the UI and can be programmed
(hence selectable) 
```
"zone": 40
"id": "allnuts"
"x": 87"y": 5
"w": 12
"h": 10
"zoom": 3
"selectable": true
"name": "All Walnuts"
"group": 1                       // a numeric 'handle' for the group (a zone can be in more than 1 group)
"zones": [1, 2, 3, 4, 5]         // list of zones in the group
```

Another virtual zone that has no valves but in this case operates on a specific internal function (test mode)
```
"zone": 43
"id": "test"
"x": 87
"y": 92
"w": 12
"h":  5
"zoom": 3
"selectable": true
"name": "Test Valves"
"istest": true                   // say what it does
```



